import{U as x,_ as C,o as c,c as u,a as l,w as m,v as g,b as I,t as p,d as v}from"./index-_oq92NXM.js";function w(t){return/^[\u4e00-\u9fa5]{2,}$/.test(t)}function k(t,e){return x.getPinyin(t).map(n=>n.charAt(0).toLowerCase()).join("").startsWith(e.toLowerCase())}function b(t){if(!t){alert("请输入拼音首字母");return}let e=window.Application.ActiveSheet;if(!e){alert("当前没有激活的工作表");return}let r=e.UsedRange.Rows.Count,o=e.UsedRange.Columns.Count,n=[],i=-1;for(let s=1;s<=r;s++)for(let a=1;a<=o;a++){let d=e.Cells.Item(s,a).Text;w(d)&&k(d,t)&&(n.some(f=>f.row===s&&f.col===a)||n.push({row:s,col:a,name:d}))}if(n.length>0){i=0;let s=n[0];return e.Cells.Item(s.row,s.col).Activate(),{count:n.length,foundIndex:i,matches:n}}else return alert("未找到符合条件的姓名"),{count:0,foundIndex:-1,matches:[]}}function M(t){if(!t||typeof t!="object"||!t.direction||!t.matches||t.currentMatchIndex===void 0){alert("参数错误，无法定位匹配项");return}let{direction:e,matches:r,currentMatchIndex:o}=t,n=o;if(e==="next")n=(o+1)%r.length;else if(e==="previous")n=(o-1+r.length)%r.length;else{alert("方向参数无效，必须是 'next' 或 'previous'");return}let i=r[n],s=window.Application.ActiveSheet;return s&&s.Cells.Item(i.row,i.col).Activate(),{count:r.length,foundIndex:n}}function y(){let t=window.Application.ActiveSheet;if(!t)return alert("当前没有激活的工作表"),null;let e=t.UsedRange.Rows.Count,r=t.UsedRange.Columns.Count;for(let o=1;o<=e;o++)for(let n=1;n<=r;n++){let i=t.Cells.Item(o,n).Text;if(i&&i.includes("成绩"))return n}return alert("未找到包含“成绩”的列"),null}function A(t){if(!t){alert("参数无效，请传入行号和成绩数组");return}let e=window.Application.ActiveSheet;if(!e){alert("当前没有激活的工作表");return}let r=y();if(!r){alert("未找到包含“成绩”的列，无法录入成绩");return}let{row:o,grade:n}=t;e.Cells.Item(o,r).Formula=n}const h={onbuttonclick:b,navigateMatch:M,gradesubmit:A},L={name:"Dialog",data(){return{searchInitials:"",grade:"",searchPerformed:!1,matchCount:0,currentIndex:-1,matches:[]}},methods:{onNameLocatedClick(){const t=h.onbuttonclick(this.searchInitials);if(t&&t.count>0?(this.matchCount=t.count,this.matches=t.matches,this.currentIndex=t.foundIndex,this.searchPerformed=!0):(this.matchCount=0,this.matches=[],this.currentIndex=-1,this.searchPerformed=!0),this.matchCount>1)alert("有同首字母的兄弟，手动介入一下吧");else{const e={row:this.matches[this.currentIndex].row,grade:this.grade};h.gradesubmit(e),this.searchInitials="",this.grade="",this.$nextTick(()=>{this.$refs.searchInitialsInput.blur(),setTimeout(()=>{this.$refs.searchInitialsInput.focus()},0)})}},navigateMatch(t){if(this.matches.length>0){const e={direction:t,matches:this.matches,currentMatchIndex:this.currentIndex},r=h.navigateMatch(e);r&&r.foundIndex!==void 0&&(this.currentIndex=r.foundIndex)}}}},S={class:"dialog-container"},_={class:"dialog-box"},N={class:"content"},U={class:"search-bar"},R={key:0,class:"match-info"},V={key:0,class:"navigation-buttons"},P={key:1,class:"no-matches"};function T(t,e,r,o,n,i){return c(),u("div",S,[l("div",_,[e[7]||(e[7]=l("div",{class:"header"},[l("h2",null,"姓名定位小程序")],-1)),l("div",N,[l("div",U,[m(l("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.searchInitials=s),placeholder:"请输入姓名拼音首字母",class:"search-input",ref:"searchInitialsInput",onKeyup:e[1]||(e[1]=I((...s)=>i.onNameLocatedClick&&i.onNameLocatedClick(...s),["enter"]))},null,544),[[g,n.searchInitials]]),m(l("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>n.grade=s),placeholder:"请输入成绩",class:"search-input",onKeyup:e[3]||(e[3]=I((...s)=>i.onNameLocatedClick&&i.onNameLocatedClick(...s),["enter"]))},null,544),[[g,n.grade]])]),n.matchCount>0?(c(),u("div",R,[l("p",null,"匹配结果："+p(n.currentIndex+1)+"/"+p(n.matchCount),1),n.matchCount>1?(c(),u("div",V,[l("button",{onClick:e[4]||(e[4]=s=>i.navigateMatch("previous")),class:"navigate-button"},"⬆ 上一行"),l("button",{onClick:e[5]||(e[5]=s=>i.navigateMatch("next")),class:"navigate-button"},"⬇ 下一行")])):v("",!0)])):n.searchPerformed?(c(),u("div",P,e[6]||(e[6]=[l("p",null,"未找到符合条件的姓名",-1)]))):v("",!0)])])])}const B=C(L,[["render",T],["__scopeId","data-v-308e0d46"]]);export{B as default};
